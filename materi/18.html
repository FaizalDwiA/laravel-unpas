<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Create Post Form</title>
    <style>
        .vscode-dark img[src$="\#gh-light-mode-only"],
        .vscode-light img[src$="\#gh-dark-mode-only"] {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet"
        type="text/css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css" />
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC",
                "Segoe UI", system-ui, "Ubuntu", "Droid Sans", sans-serif;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
    <style>
        .task-list-item {
            list-style-type: none;
        }

        .task-list-item-checkbox {
            margin-left: -20px;
            vertical-align: middle;
            pointer-events: none;
        }
    </style>
</head>

<body class="vscode-body vscode-light">
    <h1 id="create-post-form">Create Post Form</h1>
    <hr />
    <h2 id="menambahkan-tombol-postingan">menambahkan tombol postingan</h2>
    <p>Buka file <em>resource/views/posts/index.blade.php</em></p>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\1.webp" alt="1" />
    </p>
    <blockquote>
        <p>
            tidak not found / 404: karena sudah ditangani oleh laravel /
            default
        </p>
    </blockquote>
    <p>buka file <em>DashboardController.php</em></p>
    <p>kita ketikkan di method <strong>create()</strong></p>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\2.webp" alt="2" />
    </p>
    <p>
        kita buat file baru <em>resource/views/posts/create.blade.php</em>
    </p>
    <blockquote>
        <p>isinya kita copy dari halaman <em>post/index.blade.php</em></p>
    </blockquote>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\3.webp" alt="3" />
    </p>
    <p>kita buka <em>sidebar.blade.php</em></p>
    <blockquote>
        <p>
            sebuah wildcard / * berfungsi : apapun yang ada setelah tanda
            post akan membuat halaman ini active
        </p>
    </blockquote>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\4.webp" alt="4" />
    </p>
    <p>
        kita buka lagi file <em>create.blade.php</em> untuk kita membuat
        form
    </p>
    <blockquote>
        <p>kita kecilkan inputannnya untuk input di desktop</p>
    </blockquote>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-lg-8&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\5.webp" alt="5" />
    </p>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\6.webp" alt="6" />
    </p>
    <blockquote>
        <p>
            form diatas jika digabung dengan method post akan mengarah ke
            method store di ControllerPostController
            <strong>Karena kita pakai resource</strong>
        </p>
    </blockquote>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\7.webp" alt="7" />
    </p>
    <blockquote>
        <p>
            jika halamannya menuju ke route diatas dengan method
            <strong>get</strong> dia akan langsung ke index, kalo method
            <strong>post</strong> akan langsung ke method store,
            <strong>put</strong> akan mengarahkan ke update, kalo
            <strong>delete</strong> akan mengarahkan ke destrory.
        </p>
    </blockquote>
    <p>
        kalo kita menggunakan form jangan lupa menggunakan directive CSRF
        untuk menangani Cross Side Resource Forgery
    </p>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mb-3&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;title&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-label&quot;</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;title&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;title&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mb-3&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;slug&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-label&quot;</span>&gt;</span>Slug<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;slug&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;slug&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Create Post<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
    <p>
        kita akan membuat slugnya menjadi otomatis ketika pencet tab /
        pindah focus dari title.
    </p>
    <p>
        kita butuh bantuan sebuah package tugasnya untuk membuat slug :
        <strong>eloquent sluggable</strong>
    </p>
    <h3 id="eloquent-sluggable">Eloquent Sluggable</h3>
    <p>
        <a href="https://github.com/cviebrock/eloquent-sluggable">Link Eloquent Sluggable</a>
    </p>
    <p>kita install dulu lewat composer:</p>
    <pre><code>composer require cviebrock/eloquent-sluggable
</code></pre>
    <p>kita copy script dibawah ini:</p>
    <pre><code class="language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Cviebrock</span>\<span class="hljs-title">EloquentSluggable</span>\<span class="hljs-title">Sluggable</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Post</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">Sluggable</span>;

    <span class="hljs-comment">/**
     * Return the sluggable configuration array for this model.
     *
     * <span class="hljs-doctag">@return</span> array
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sluggable</span>(<span class="hljs-params"></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">&#x27;slug&#x27;</span> =&gt; [
                <span class="hljs-string">&#x27;source&#x27;</span> =&gt; <span class="hljs-string">&#x27;title&#x27;</span>
            ]
        ];
    }
}
</code></pre>
    <blockquote>
        <p>
            kita include kan namespacenya kita panggil track nya kita
            membuat method sluggable
        </p>
    </blockquote>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\8.webp" alt="8" />
    </p>
    <blockquote>
        <p>trait / use wajib kita bikin methodnya</p>
    </blockquote>
    <blockquote>
        <p>
            karena kita mau bikin ketika dari title langsung dibuat slugnya,
            harus menggunakan <strong>javascript</strong>
        </p>
    </blockquote>
    <h2 id="membuat-fetch-api">membuat fetch API</h2>
    <p>
        kita buat method baru di file
        <em>DashboardPostController.php</em> dengan nama
        <strong>checkSlug</strong>
    </p>
    <pre><code class="language-php"><span class="hljs-keyword">use</span> \<span class="hljs-title">Cviebrock</span>\<span class="hljs-title">EloquentSluggable</span>\<span class="hljs-title">Services</span>\<span class="hljs-title">SlugService</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSlug</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>) </span>{
    <span class="hljs-variable">$slug</span> = <span class="hljs-title class_">SlugService</span>::<span class="hljs-title function_ invoke__">createSlug</span>(<span class="hljs-title class_">Post</span>::<span class="hljs-variable language_">class</span>, <span class="hljs-string">&#x27;slug&#x27;</span>, <span class="hljs-variable">$request</span>-&gt;title);
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">&#x27;slug&#x27;</span> =&gt; <span class="hljs-variable">$slug</span>]);
}
</code></pre>
    <blockquote>
        <p>
            dibaca: CreateSlug mengambil dari class post, mengambil fieldnya
            slug, sumbernya / titlenya apa, slug akan berisi apapun hasilnya
            yag sudah diisi titlenya dan uniq dari database kita return
            dalam bentuk JSON, agar bisa bisa diolah oleh JSON javascript,
            dalam bentuk aray assoiative,
        </p>
    </blockquote>
    <p>kita buat di <em>create.blade.php</em> javascript</p>
    <pre><code class="language-js"><span class="hljs-keyword">const</span> title = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#title&quot;</span>);
<span class="hljs-keyword">const</span> slug = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#slug&quot;</span>);

title.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/dashboard/posts/checkSlug?title&quot;</span> + title.<span class="hljs-property">value</span>)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.<span class="hljs-title function_">json</span>())
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> (slug.<span class="hljs-property">value</span> = data.<span class="hljs-property">slug</span>));
});
</code></pre>
    <blockquote>
        <p>
            setelah dapat promisenya resolve, data.slugnya masuk sebagai
            value diinputan slug
        </p>
    </blockquote>
    <p>karena bukan bagian dari resource maka buat Routenya manual</p>
    <pre><code class="language-php"><span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;/dashboard/posts/checkSlug&#x27;</span>, [<span class="hljs-title class_">DashboardPostController</span>::<span class="hljs-variable language_">class</span>, <span class="hljs-string">&#x27;checkSlug&#x27;</span>])-&gt;<span class="hljs-title function_ invoke__">middleware</span>(<span class="hljs-string">&#x27;auth&#x27;</span>);
</code></pre>
    <p>
        Hasil:
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\9.webp" alt="9" />
    </p>
    <blockquote>
        <p>
            kita bisa membuat inputan slugnya
            <strong>disable dan readonly</strong>
        </p>
    </blockquote>
    <h2 id="kita-membuat-select-untuk-category">
        kita membuat select untuk category
    </h2>
    <p>
        kita edit method <strong>create</strong> di file
        <em>DashboardPostController.php</em> agar bisa looping data dari
        models Category.
    </p>
    <pre><code class="language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Models</span>\<span class="hljs-title">Category</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">view</span>(<span class="hljs-string">&#x27;dashboard.posts.create&#x27;</span>, [
        <span class="hljs-string">&#x27;categories&#x27;</span> =&gt; <span class="hljs-attr">Category</span>:<span class="hljs-title function_ invoke__">all</span>();
    ]);
}
</code></pre>
    <p>kita tambahkan script select:</p>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mb-3&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;category&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-label&quot;</span>&gt;</span>Category<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;category_id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-select&quot;</span>&gt;</span>
        @foreach ($Categories as @category)
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{ $category-&gt;id }}&quot;</span>&gt;</span>{{ @category-&gt;name }}<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        @endforeach
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
    <h2 id="menambahkan-sebuah-editor-untuk-menulis-body">
        menambahkan sebuah editor untuk menulis body
    </h2>
    <p>kita cari sebuah editor namanya <strong>trix editor</strong></p>
    <p><a href="https://github.com/basecamp/trix">link trix editor</a></p>
    <p>
        <img src="file:///d:\Project\com.fda.laravel\aset\img\18\10.webp" alt="10" />
    </p>
    <ol>
        <li>kita tambahkan 2 baris diatas halaman html kita</li>
    </ol>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    …
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/css/trix.css&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/js/trix.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</code></pre>
    <ol start="2">
        <li>kita download source codenya</li>
        <li>kita tambahkan script untuk trix-editor, namanya harus sama</li>
        <li>
            kita ambil file
            <em>dist/trix.js &amp; dist/trix.css</em> pindahkan ke folder
            public
        </li>
        <li>kita tambahkan script:</li>
    </ol>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mb-3&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;body&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-label&quot;</span>&gt;</span>Body<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;body&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;body&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">trix-editor</span> <span class="hljs-attr">input</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">trix-editor</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
    <h3 id="hilangkan-file-upload">hilangkan file upload</h3>
    <p>hilangkan diCSS:</p>
    <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">
    trix-toolbar <span class="hljs-selector-attr">[data-trix-button-group=<span class="hljs-string">&quot;file-tools&quot;</span>]</span> {
        <span class="hljs-attribute">display</span>: none;
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
    <p>agar tidak jalan fitur nya kita kasih js:</p>
    <pre><code class="language-js"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;&#x27;</span>trix-file-accept<span class="hljs-string">&#x27;, function(){
    e.preventDefault();
});
</span></code></pre>

    <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
</body>

</html>